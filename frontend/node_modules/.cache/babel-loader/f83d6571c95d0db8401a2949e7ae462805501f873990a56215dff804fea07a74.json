{"ast":null,"code":"import _regeneratorRuntime from\"/Users/loicpeyramaure/Gw2 Talk/Gw2-Talk/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/loicpeyramaure/Gw2 Talk/Gw2-Talk/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/loicpeyramaure/Gw2 Talk/Gw2-Talk/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{jwtDecode}from'jwt-decode';import logo from\"./images/logo.svg\";import defaultAvatar from'./images/default-avatar.png';import'./DisplayPosts.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function DisplayPosts(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var navigate=useNavigate();var token=localStorage.getItem('token');var currentUserId=null;if(token){try{var decodedToken=jwtDecode(token);currentUserId=decodedToken.userId;}catch(error){console.error('Error decoding token:',error);}}useEffect(function(){var fetchPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios.get('https://gw2test-5b5b5deabf74.herokuapp.com/get-posts');case 3:response=_context.sent;setPosts(response.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.error('Error fetching posts:',_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function fetchPosts(){return _ref.apply(this,arguments);};}();fetchPosts();},[]);var navigateToAccount=function navigateToAccount(){navigate('/create-post');};var handleDeletePost=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(postId){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(token){_context2.next=3;break;}console.error('Authentication token not found');return _context2.abrupt(\"return\");case 3:_context2.next=5;return axios.delete(\"https://gw2test-5b5b5deabf74.herokuapp.com/posts/\".concat(postId),{headers:{'Authorization':\"Bearer \".concat(token)}});case 5:setPosts(posts.filter(function(post){return post.id!==postId;}));case 6:case\"end\":return _context2.stop();}},_callee2);}));return function handleDeletePost(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"main-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header1\",children:[/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"Logo\"}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return navigate('/account');},children:\"Mon compte\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"banner\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Bienvenue dans mon forum GW2\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"discussions-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Discussions\"}),/*#__PURE__*/_jsx(\"span\",{onClick:navigateToAccount,children:\"\\uFF0B\"})]}),posts.map(function(post){return/*#__PURE__*/_jsxs(\"div\",{className:\"post\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-user-info\",children:[/*#__PURE__*/_jsx(\"img\",{src:post.compteImage?\"https://gw2test-5b5b5deabf74.herokuapp.com/\".concat(post.compteImage):defaultAvatar,alt:\"\".concat(post.userName?post.userName:\"User\",\"'s avatar\")}),/*#__PURE__*/_jsxs(\"span\",{children:[post.userName,\" / \",post.gw2_account_name]})]}),/*#__PURE__*/_jsx(\"h3\",{onClick:function onClick(){return navigate(\"/posts/\".concat(post.id));},children:post.title}),/*#__PURE__*/_jsxs(\"p\",{children:[post.content.substring(0,100),\"...\"]}),currentUserId&&post.user_id===currentUserId&&/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleDeletePost(post.id);},title:\"Supprimer poste\",children:\"\\u274C\"}),posts.length-1!==posts.indexOf(post)&&/*#__PURE__*/_jsx(\"hr\",{className:\"hr-style\"})]},post.id);}),/*#__PURE__*/_jsxs(\"div\",{className:\"footer\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"Contact: lpeyramaure@eduvaud.ch\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Nombre d'inscrits: 451\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Nombre de posts: 645\"})]})]});}export default DisplayPosts;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jwtDecode","logo","defaultAvatar","jsx","_jsx","jsxs","_jsxs","DisplayPosts","_useState","_useState2","_slicedToArray","posts","setPosts","navigate","token","localStorage","getItem","currentUserId","decodedToken","userId","error","console","fetchPosts","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_callee$","_context","prev","next","get","sent","data","t0","stop","apply","arguments","navigateToAccount","handleDeletePost","_ref2","_callee2","postId","_callee2$","_context2","abrupt","delete","concat","headers","filter","post","id","_x","className","children","src","alt","onClick","map","compteImage","userName","gw2_account_name","title","content","substring","user_id","length","indexOf"],"sources":["/Users/loicpeyramaure/Gw2 Talk/Gw2-Talk/frontend/src/DisplayPosts.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useNavigate } from 'react-router-dom';\nimport { jwtDecode } from 'jwt-decode';\nimport logo from \"./images/logo.svg\";\nimport defaultAvatar from './images/default-avatar.png';\nimport './DisplayPosts.css';\n\nfunction DisplayPosts() {\n    const [posts, setPosts] = useState([]);\n    const navigate = useNavigate();\n    const token = localStorage.getItem('token');\n    let currentUserId = null;\n    if (token) {\n        try {\n            const decodedToken = jwtDecode(token);\n            currentUserId = decodedToken.userId;\n        } catch (error) {\n            console.error('Error decoding token:', error);\n        }\n    }\n\n    useEffect(() => {\n        const fetchPosts = async () => {\n            try {\n                const response = await axios.get('https://gw2test-5b5b5deabf74.herokuapp.com/get-posts');\n                setPosts(response.data);\n            } catch (error) {\n                console.error('Error fetching posts:', error);\n            }\n        };\n        fetchPosts();\n    }, []);\n\n    const navigateToAccount = () => {\n        navigate('/create-post');\n    };\n\n    const handleDeletePost = async (postId) => {\n        if (!token) {\n            console.error('Authentication token not found');\n            return;\n        }\n        await axios.delete(`https://gw2test-5b5b5deabf74.herokuapp.com/posts/${postId}`, {\n            headers: { 'Authorization': `Bearer ${token}` }\n        });\n        setPosts(posts.filter(post => post.id !== postId));\n    };\n\n    return (\n        <div className=\"main-container\">\n            {/* Header */}\n            <div className=\"header1\">\n                <img src={logo} alt='Logo' />\n                <span onClick={() => navigate('/account')}>Mon compte</span>\n            </div>\n\n            {/* Banner */}\n            <div className=\"banner\">\n                <h1>Bienvenue dans mon forum GW2</h1>\n            </div>\n\n            {/* Discussions Header */}\n            <div className=\"discussions-header\">\n                <h2>Discussions</h2>\n                <span onClick={navigateToAccount}>＋</span>\n            </div>\n\n            {/* Posts */}\n            {posts.map((post) => (\n                <div key={post.id} className=\"post\">\n                    <div className=\"post-user-info\">\n                        <img\n                            src={post.compteImage ? `https://gw2test-5b5b5deabf74.herokuapp.com/${post.compteImage}` : defaultAvatar}\n                            alt={`${post.userName ? post.userName : \"User\"}'s avatar`}\n                        />\n                        <span>{post.userName} / {post.gw2_account_name}</span>\n                    </div>\n                    <h3 onClick={() => navigate(`/posts/${post.id}`)}>{post.title}</h3>\n                    <p>{post.content.substring(0, 100)}...</p>\n                    {currentUserId && post.user_id === currentUserId && (\n                        <button onClick={() => handleDeletePost(post.id)} title=\"Supprimer poste\">❌</button>\n                    )}\n                    {posts.length - 1 !== posts.indexOf(post) && (\n    <hr className=\"hr-style\" />\n)}\n                </div>\n            ))}\n\n            {/* Footer */}\n            <div className=\"footer\">\n                <p>Contact: lpeyramaure@eduvaud.ch</p>\n                <p>Nombre d'inscrits: 451</p>\n                <p>Nombre de posts: 645</p>\n            </div>\n        </div>\n    );\n}\n\nexport default DisplayPosts;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}